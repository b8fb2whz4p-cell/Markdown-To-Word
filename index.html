<!DOCTYPE html>

<html lang="zh-CN"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
    
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Markdownè½¬Wordç¥å™¨</title>

    <!-- å†…è” marked.js æ ¸å¿ƒåŠŸèƒ½ -->
    <script>
    // æ”¹è¿›ç‰ˆ marked.js æ ¸å¿ƒåŠŸèƒ½å®ç°
    (function() {
      // é…ç½®é€‰é¡¹
      var markedOptions = {
        breaks: true,
        gfm: true,
        pedantic: false,
        smartLists: true,
        smartypants: false
      };

      // ä¸»è§£æå‡½æ•°
      function parseMarkdown(text) {
        if (!text) return '';
        
        // å¤„ç†æ–‡æœ¬ä¸­çš„ç‰¹æ®Šå­—ç¬¦è½¬ä¹‰
        text = text.replace(/&/g, '&amp;').replace(/</g, '&lt;').replace(/>/g, '&gt;');
        
        // æ ‡é¢˜å¤„ç†
        text = text.replace(/^(#{1,6})\s+([^\n]+)/gm, function(match, hashes, content) {
          var level = hashes.length;
          return '<h' + level + '>' + content + '</h' + level + '>';
        });
        
        // ç²—ä½“å’Œæ–œä½“å¤„ç† - å…ˆå¤„ç†ç²—ä½“ï¼Œé¿å…å†²çª
        text = text.replace(/\*\*(.*?)\*\*/g, '<strong>$1</strong>');
        text = text.replace(/\*(.*?)\*/g, '<em>$1</em>');
        
        // ä»£ç å—å¤„ç†ï¼ˆéœ€è¦å…ˆå¤„ç†ï¼Œé¿å…è¢«åç»­è§„åˆ™å½±å“ï¼‰
        var codeBlocks = [];
        text = text.replace(/```([\s\S]*?)```/g, function(match, code) {
          codeBlocks.push(code);
          return '___CODE_BLOCK_' + (codeBlocks.length - 1) + '___';
        });
        
        // è¡Œå†…ä»£ç å¤„ç†
        text = text.replace(/`([^`]+)`/g, '<code>$1</code>');
        
        // é“¾æ¥å¤„ç†
        text = text.replace(/\[(.*?)\]\((.*?)\)/g, '<a href="$2">$1</a>');
        
        // å¼•ç”¨å¤„ç†
        text = processBlockElements(text, /^(\s*>\s*)([^\n]+)/gm, 'blockquote');
        
        // æ— åºåˆ—è¡¨å¤„ç† (æ”¯æŒ -, +, * ä¸‰ç§æ ‡è®°)
        text = processBlockElements(text, /^(\s*)(?:-|\+|\*)\s+([^\n]+)/gm, 'ul', function(content) {
          return content.replace(/^(\s*)(?:-|\+|\*)\s+([^\n]+)/gm, '  <li>$2</li>');
        });
        
        // æœ‰åºåˆ—è¡¨å¤„ç†
        text = processBlockElements(text, /^(\s*)(\d+)\.\s+([^\n]+)/gm, 'ol', function(content) {
          return content.replace(/^(\s*)(\d+)\.\s+([^\n]+)/gm, '  <li>$3</li>');
        });
        
        // è¡¨æ ¼å¤„ç†
        text = text.replace(/^(\|.*\|)\n(\|\s*-+\s*\|.*\|)\n((?:\|.*\|\n)*)/gm, function(match, header, separator, rows) {
          // å¤„ç†è¡¨å¤´
          var headerCells = header.split('|').slice(1, -1); // ç§»é™¤é¦–å°¾çš„|å¹¶åˆ†å‰²
          var thead = '<thead><tr>';
          headerCells.forEach(function(cell) {
            thead += '<th>' + cell.trim() + '</th>';
          });
          thead += '</tr></thead>';
          
          // å¤„ç†è¡Œ
          var rowLines = rows.trim().split('\n');
          var tbody = '<tbody>';
          rowLines.forEach(function(row) {
            var cells = row.split('|').slice(1, -1);
            tbody += '<tr>';
            cells.forEach(function(cell) {
              tbody += '<td>' + cell.trim() + '</td>';
            });
            tbody += '</tr>';
          });
          tbody += '</tbody>';
          
          return '<table>' + thead + tbody + '</table>';
        });
        
        // æ®µè½å¤„ç† - åœ¨æœ€åå¤„ç†ï¼Œé¿å…å½±å“å…¶ä»–å—çº§å…ƒç´ 
        var paragraphs = text.split('\n\n');
        var result = '';
        for (var i = 0; i < paragraphs.length; i++) {
          var para = paragraphs[i].trim();
          if (!para) continue;
          
          // æ£€æŸ¥æ˜¯å¦å·²ç»æ˜¯å—çº§å…ƒç´ 
          if (!/^<(h[1-6]|ul|ol|blockquote|pre|table)/i.test(para)) {
            // å¤„ç†æ®µè½å†…çš„æ¢è¡Œ
            if (markedOptions.breaks) {
              para = para.replace(/\n/g, '<br>');
            }
            para = '<p>' + para + '</p>';
          }
          
          result += para + '\n\n';
        }
        
        // æ¢å¤ä»£ç å—
        for (var i = 0; i < codeBlocks.length; i++) {
          result = result.replace('___CODE_BLOCK_' + i + '___', '<pre><code>' + codeBlocks[i] + '</code></pre>');
        }
        
        return result.trim();
      }
      
      // è¾…åŠ©å‡½æ•°ï¼šå¤„ç†å—çº§å…ƒç´ 
      function processBlockElements(text, regex, tag, contentProcessor) {
        var blocks = [];
        var blockRegex = new RegExp(regex.source, regex.flags);
        
        // æ‰¾å‡ºæ‰€æœ‰åŒ¹é…çš„å—
        var match;
        var lastIndex = 0;
        var parts = [];
        
        while ((match = blockRegex.exec(text)) !== null) {
          if (match.index > lastIndex) {
            parts.push(text.substring(lastIndex, match.index));
          }
          
          // æŸ¥æ‰¾å®Œæ•´çš„å—ï¼ˆåŒ…å«æ‰€æœ‰è¿ç»­çš„åŒ¹é…è¡Œï¼‰
          var blockStart = match.index;
          var blockEnd = blockRegex.lastIndex;
          var lineEnd;
          
          // ç»§ç»­æŸ¥æ‰¾åç»­çš„åŒ¹é…è¡Œ
          while ((lineEnd = text.indexOf('\n', blockEnd)) !== -1) {
            var nextLineStart = lineEnd + 1;
            var nextLine = text.substring(nextLineStart, text.indexOf('\n', nextLineStart) !== -1 ? text.indexOf('\n', nextLineStart) : text.length);
            
            if (regex.test(nextLine)) {
              blockEnd = text.indexOf('\n', nextLineStart) !== -1 ? text.indexOf('\n', nextLineStart) : text.length;
            } else {
              break;
            }
          }
          
          var blockContent = text.substring(blockStart, blockEnd);
          blocks.push(blockContent);
          parts.push('___BLOCK_' + (blocks.length - 1) + '___');
          
          lastIndex = blockEnd;
          blockRegex.lastIndex = blockEnd;
        }
        
        if (lastIndex < text.length) {
          parts.push(text.substring(lastIndex));
        }
        
        var result = parts.join('');
        
        // å¤„ç†å¹¶æ¢å¤å—
        for (var i = 0; i < blocks.length; i++) {
          var processedContent;
          if (contentProcessor) {
            processedContent = contentProcessor(blocks[i]);
          } else {
            processedContent = blocks[i];
          }
          result = result.replace('___BLOCK_' + i + '___', '<' + tag + '>' + processedContent + '</' + tag + '>');
        }
        
        return result;
      }
      
      // å¯¼å‡º marked å¯¹è±¡
      window.marked = {
        parse: parseMarkdown,
        setOptions: function(options) {
          if (options) {
            for (var key in options) {
              if (options.hasOwnProperty(key)) {
                markedOptions[key] = options[key];
              }
            }
          }
        }
      };
    })();
    </script>
    
    <!-- å†…è” FileSaver.js æ ¸å¿ƒåŠŸèƒ½ -->
    <script>
    // æ”¹è¿›ç‰ˆ FileSaver.js å®ç°
    (function() {
      'use strict';
      
      // æ£€æµ‹æ˜¯å¦æ”¯æŒä¿å­˜åŠŸèƒ½
      var saveAs = saveAs || (function(view) {
        // åˆ›å»º URL
        var get_URL = function() {
          return view.URL || view.webkitURL || view;
        };
        
        // åˆ›å»º Blob
        var save_link = document.createElementNS('http://www.w3.org/1999/xhtml', 'a');
        var can_use_save_link = 'download' in save_link;
        
        // ä¿å­˜æ–‡ä»¶å‡½æ•°
        var click = function(node) {
          var event = new MouseEvent('click');
          node.dispatchEvent(event);
        };
        
        // å®ç° saveAs å‡½æ•°
        return function(blob, name, opts) {
          // ç¡®ä¿ blob æ ¼å¼æ­£ç¡®
          var blob = blob instanceof Blob ? blob : new Blob([blob], {type: 'application/octet-stream'});
          
          // å¤„ç†æ–‡ä»¶å
          name = name || blob.name || 'download';
          
          // å¦‚æœæ”¯æŒç›´æ¥ä¸‹è½½
          if (can_use_save_link) {
            var url = get_URL().createObjectURL(blob);
            save_link.href = url;
            save_link.download = name;
            click(save_link);
            // å»¶è¿Ÿæ’¤é”€ URL ä»¥ç¡®ä¿ä¸‹è½½å®Œæˆ
            setTimeout(function() {
              get_URL().revokeObjectURL(url);
            }, 100);
            return save_link;
          }
          
          // å¯¹äº IE æµè§ˆå™¨çš„å…¼å®¹
          if (navigator.msSaveBlob) {
            return navigator.msSaveBlob(blob, name);
          }
          
          // é™çº§æ–¹æ¡ˆ
          var url = get_URL().createObjectURL(blob);
          var opened = view.open(url, '_blank');
          if (!opened) {
            // å¦‚æœæ— æ³•æ‰“å¼€æ–°çª—å£ï¼Œå°è¯•å…¶ä»–æ–¹æ³•
            view.location.href = url;
          }
          // å»¶è¿Ÿæ’¤é”€ URL
          setTimeout(function() {
            get_URL().revokeObjectURL(url);
          }, 4000);
        };
      })(window);
      
      // å¯¼å‡ºåˆ°å…¨å±€
      if (typeof module !== 'undefined' && module.exports) {
        module.exports.saveAs = saveAs;
      } else {
        window.saveAs = saveAs;
      }
    })();
    </script>
    
    <!-- å†…è” HTML è½¬ DOC åŠŸèƒ½ -->
    <script>
    // æ”¹è¿›ç‰ˆ HTML è½¬ DOC åŠŸèƒ½å®ç°
    (function() {
      // ä¸»å¯¼å‡ºå‡½æ•°
      function htmlDocxExport(html) {
        // åˆ›å»ºå®Œæ•´çš„Wordå…¼å®¹HTMLæ–‡æ¡£
        var content = generateWordHtml(html);
        
        // ä½¿ç”¨æ›´å…¼å®¹çš„MIMEç±»å‹ï¼Œç¡®ä¿Wordèƒ½æ­£ç¡®æ‰“å¼€
        var blob = new Blob([content], { 
          type: 'application/msword;charset=utf-8' 
        });
        
        return blob;
      }
      
      // ç”ŸæˆWordå…¼å®¹çš„HTMLç»“æ„
        function generateWordHtml(htmlContent) {
          // ä½¿ç”¨æ›´ç®€å•ç›´æ¥çš„Wordå…¼å®¹HTMLç»“æ„
          var template = `<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Transitional//EN" "http://www.w3.org/TR/xhtml1/DTD/xhtml1-transitional.dtd">
<html xmlns="http://www.w3.org/1999/xhtml">
<head>
  <meta http-equiv="Content-Type" content="text/html; charset=utf-8" />
  <title>Markdown æ–‡æ¡£</title>
  <style>
    /* å…¨å±€è®¾ç½®ä¸ºå¾®è½¯é›…é»‘å­—ä½“ï¼Œç¡®ä¿æ‰€æœ‰æ–‡æœ¬å…ƒç´ ï¼ˆåŒ…æ‹¬è¡¨æ ¼å’Œè‹±æ–‡ï¼‰éƒ½ä½¿ç”¨å¾®è½¯é›…é»‘ */
    * {
      font-family: "Microsoft YaHei", "å¾®è½¯é›…é»‘", sans-serif !important;
    }
    
    /* ç¡®ä¿bodyå’Œæ‰€æœ‰å†…å®¹å…ƒç´ ä½¿ç”¨å¾®è½¯é›…é»‘ */
    body, h1, h2, h3, h4, h5, h6, p, ul, ol, li, th, td, blockquote, span, div, a {
      font-family: "Microsoft YaHei", "å¾®è½¯é›…é»‘", sans-serif;
    }
    
    body { 
      font-size: 16px;
      line-height: 1.5;
      margin: 0.5cm;
      color: #000000;
    }
    h1 { font-size: 24px; font-weight: bold; margin: 1em 0; }
    h2 { font-size: 20px; font-weight: bold; margin: 1em 0; }
    h3 { font-size: 18px; font-weight: bold; margin: 1em 0; }
    p { margin: 0.8em 0; text-indent: 2em; }
    ul, ol { margin: 1em 0; padding-left: 2em; }
    li { margin: 0.5em 0; }
    table { border-collapse: collapse; width: 100%; margin: 1em 0; }
    table, th, td { border: 1px solid #000; }
    /* ç¡®ä¿è¡¨æ ¼å•å…ƒæ ¼æ–‡å­—ä½¿ç”¨å¾®è½¯é›…é»‘ */
    th, td { 
      padding: 6px;
      font-family: "Microsoft YaHei", "å¾®è½¯é›…é»‘", sans-serif;
    }
    th { background-color: #ddd; }
    /* ä»£ç å—ä¿æŒç­‰å®½å­—ä½“ï¼Œä½†ç¡®ä¿æ³¨é‡Šéƒ¨åˆ†å¯èƒ½çš„ä¸­æ–‡ä¹Ÿèƒ½æ­£ç¡®æ˜¾ç¤º */
    pre, code { 
      font-family: "Courier New", monospace, "Microsoft YaHei", "å¾®è½¯é›…é»‘"; 
      background-color: #f5f5f5;
    }
    pre { padding: 10px; overflow: auto; }
    code { padding: 2px 4px; }
    blockquote { border-left: 3px solid #ddd; padding-left: 1em; margin-left: 0; color: #666; }
  </style>
</head>
<body>
  ${htmlContent}
</body>
</html>`;
        
        return template;
      }
      
      // å¯¼å‡ºåˆ°å…¨å±€
      window.htmlDocxExport = htmlDocxExport;
    })();
    </script>

    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        /* ===== å…¨å±€å­—ä½“ç³»ç»Ÿ ===== */
        body {
            font-family: "å¾®è½¯é›…é»‘", "Microsoft YaHei", Arial, sans-serif;
            background-color: #f7f8fa;
            color: #333;
            padding: 20px;
            min-height: 100vh;
        }

        /* ===== é¡µé¢æ ‡é¢˜ ===== */
        .header {
            text-align: center;
            margin-bottom: 30px;
            border-bottom: 1px solid #e0e0e0;
            padding-bottom: 20px;
        }

        h1 {
            font-size: 36px;
            font-weight: 800;
            color: #1a73e8;
            margin-bottom: 8px;
        }

        .header-desc {
            font-size: 18px;
            color: #5f6368;
            margin-top: 8px;
        }

        /* ===== ä¸»å®¹å™¨ ===== */
        .main-container {
            max-width: 1400px;
            margin: 0 auto;
            display: flex;
            gap: 20px;
            height: calc(100vh - 200px);
        }

        .container {
            width: 48%;
            background: #fff;
            border-radius: 8px;
            box-shadow: 0 4px 6px rgba(0,0,0,0.1);
            padding: 20px;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* ===== å·¦ä¾§è¾“å…¥åŒº ===== */
        .input-section {
            width: 48%;
        }

        .section-title {
            font-size: 23px;
            font-weight: 400;
            color: #333;
            margin-bottom: 15px;
            display: flex;
            align-items: center;
        }

        .section-title::before {
            content: '';
            display: inline-block;
            width: 4px;
            height: 23px;
            background-color: #1a73e8;
            margin-right: 10px;
            border-radius: 2px;
        }

        textarea {
            width: 100%;
            height: calc(100% - 60px);
            padding: 15px;
            border: 1px solid #ccc;
            border-radius: 4px;
            font-family: Consolas, "Courier New", monospace;
            font-size: 14px;
            resize: none;
            background-color: #fafafa;
            color: #333;
            line-height: 1.6;
            transition: border-color 0.3s, background-color 0.3s;
        }

        textarea:focus {
            outline: none;
            border-color: #1a73e8;
            background-color: #fff;
            box-shadow: 0 0 0 3px rgba(26, 115, 232, 0.1);
        }

        /* ===== å³ä¾§è¾“å‡ºåŒº ===== */
        .output-section {
            width: 48%;
        }

        .output-content {
            width: 100%;
            height: calc(100% - 60px);
            padding: 15px;
            background-color: #fdfdfd;
            border: 1px solid #ccc;
            border-radius: 4px;
            overflow-y: auto;
            line-height: 1.6;
        }

        /* ===== Word æ ·å¼ ===== */
        .word-content {
            font-family: "å¾®è½¯é›…é»‘", "Microsoft YaHei", sans-serif;
            font-size: 14px;
            color: #333;
            line-height: 1.8;
        }

        .word-content h1 {
            font-size: 28px;
            font-weight: bold;
            margin: 24px 0 16px;
            color: #1a73e8;
            border-bottom: 2px solid #1a73e8;
            padding-bottom: 8px;
        }

        .word-content h2 {
            font-size: 22px;
            font-weight: bold;
            margin: 20px 0 12px;
            color: #333;
            padding-left: 8px;
            border-left: 4px solid #1a73e8;
        }

        .word-content h3 {
            font-size: 18px;
            font-weight: bold;
            margin: 16px 0 8px;
            color: #3c4043;
        }

        .word-content h4 {
            font-size: 16px;
            font-weight: bold;
            margin: 12px 0 6px;
            color: #3c4043;
        }

        .word-content h5, .word-content h6 {
            font-size: 14px;
            font-weight: bold;
            margin: 10px 0 6px;
            color: #3c4043;
        }

        .word-content p {
            margin: 0 0 12px;
            text-align: justify;
        }

        .word-content ul, .word-content ol {
            margin: 12px 0;
            padding-left: 30px;
        }

        .word-content li {
            margin: 6px 0;
        }

        .word-content blockquote {
            margin: 12px 0;
            padding: 12px 15px;
            border-left: 4px solid #1a73e8;
            background-color: #f7f8fa;
            color: #5f6368;
        }

        .word-content code {
            font-family: Consolas, "Courier New", monospace;
            background-color: #f2f2f2;
            padding: 2px 6px;
            border-radius: 3px;
            font-size: 13px;
            color: #d73a49;
        }

        .word-content pre {
            background-color: #f2f2f2;
            border: 1px solid #e0e0e0;
            border-radius: 4px;
            padding: 12px;
            margin: 12px 0;
            overflow-x: auto;
            line-height: 1.5;
        }

        .word-content pre code {
            background-color: transparent;
            color: #333;
            padding: 0;
            font-size: 12px;
        }

        .word-table {
            border-collapse: collapse;
            width: 100%;
            margin: 12px 0;
            font-size: 14px;
            color: #333;
        }

        .word-table th, .word-table td {
            border: 1px solid #999;
            padding: 8px 12px;
            text-align: left;
        }

        .word-table th {
            background-color: #f2f2f2;
            font-weight: bold;
            color: #333;
        }

        .word-table tr:nth-child(even) {
            background-color: #fafafa;
        }

        .word-content a {
            color: #1a73e8;
            text-decoration: none;
        }

        .word-content a:hover {
            text-decoration: underline;
        }

        /* ===== æŒ‰é’®åŒºåŸŸ ===== */
        .button-group {
            display: flex;
            gap: 10px;
            margin-top: 15px;
            justify-content: center;
        }

        button {
            padding: 12px 80px;
            background-color: #1a73e8;
            color: white;
            border: none;
            border-radius: 4px;
            font-size: 16px;
            font-family: "å¾®è½¯é›…é»‘", "Microsoft YaHei", sans-serif;
            transition: background-color 0.3s, box-shadow 0.3s;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
            cursor: pointer;
            white-space: nowrap;
        }

        button:hover:not(:disabled) {
            background-color: #185abc;
            box-shadow: 0 4px 8px rgba(0,0,0,0.15);
        }

        button:active:not(:disabled) {
            background-color: #154399;
            box-shadow: 0 2px 4px rgba(0,0,0,0.1);
        }

        button:disabled {
            background-color: #b0b0b0;
            cursor: not-allowed;
            opacity: 0.6;
        }

        .button-secondary {
            background-color: #1a73e8;
        }

        .button-secondary:hover:not(:disabled) {
            background-color: #185abc;
        }

        /* ===== å“åº”å¼è®¾è®¡ ===== */
        @media (max-width: 1200px) {
            .main-container {
                flex-direction: column;
                height: auto;
            }

            .container {
                width: 100%;
                min-height: 400px;
            }

            .input-section {
                width: 100%;
            }

            .output-section {
                width: 100%;
            }
        }

        /* ===== æ»šåŠ¨æ¡æ ·å¼ ===== */
        .output-content::-webkit-scrollbar {
            width: 8px;
        }

        .output-content::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        .output-content::-webkit-scrollbar-thumb {
            background: #c0c0c0;
            border-radius: 4px;
        }

        .output-content::-webkit-scrollbar-thumb:hover {
            background: #a0a0a0;
        }

        textarea::-webkit-scrollbar {
            width: 8px;
        }

        textarea::-webkit-scrollbar-track {
            background: #f1f1f1;
            border-radius: 4px;
        }

        textarea::-webkit-scrollbar-thumb {
            background: #c0c0c0;
            border-radius: 4px;
        }

        textarea::-webkit-scrollbar-thumb:hover {
            background: #a0a0a0;
        }
    </style>
</head>
<body>
    <!-- é¡µé¢å¤´éƒ¨ -->
    <div class="header">
        <h1>Markdownè½¬Wordé«˜æ•ˆåŠå…¬åŠäº¤ä»˜</h1>
        <p class="header-desc">ä¸€é”®æ‰“é€šâ€œåˆ›ä½œâ€ä¸â€œäº¤ä»˜â€ï¼Œè®©æ ¼å¼é€‚é…æ›´é«˜æ•ˆï¼</p>
    </div>

    <!-- ä¸»å†…å®¹åŒº -->
    <div class="main-container">
        <!-- å·¦ä¾§è¾“å…¥åŒº -->
        <div class="input-section container">
            <div class="section-title">Markdownè¾“å…¥</div>
            <textarea id="markdownInput" placeholder="ç²˜è´´ä½ çš„Markdownæ–‡æœ¬åˆ°è¿™é‡Œ...
æ”¯æŒï¼š
- æ ‡é¢˜ (# ## ###)
- åˆ—è¡¨ (* -)
- è¡¨æ ¼ (| åˆ— | åˆ— |)
- ä»£ç å— (```ä»£ç ```)
- é“¾æ¥ [æ–‡å­—](url)
- ç²—ä½“ **æ–‡å­—** ç­‰"></textarea>
            <div class="button-group">
                <button onclick="convertMarkdown()">ğŸ”„ è½¬æ¢</button>
            </div>
        </div>

        <!-- å³ä¾§è¾“å‡ºåŒº -->
        <div class="output-section container">
            <div class="section-title">Wordé¢„è§ˆ</div>
            <div class="output-content word-content" id="outputContent">
                <p style="color: #999; text-align: center; padding: 40px 20px;">
                    ç‚¹å‡»å·¦ä¾§"è½¬æ¢"æŒ‰é’®ï¼ŒMarkdownå°†åœ¨è¿™é‡Œæ˜¾ç¤ºä¸ºWordé£æ ¼çš„å†…å®¹...
                </p>
            </div>
            <div class="button-group">
                <button class="button-secondary" onclick="copyToClipboard()">ğŸ“‹ å¤åˆ¶Wordå†…å®¹</button>
                <button onclick="downloadAsDoc()">â¬‡ï¸ ä¸‹è½½Wordæ–‡ä»¶</button>
            </div>
        </div>
    </div>

    <script>
        // ===== Markdownè½¬æ¢å‡½æ•° =====
          function convertMarkdown() {
              console.log('å¼€å§‹è½¬æ¢ Markdown...');
              const markdownInput = document.getElementById('markdownInput');
              console.log('è¾“å…¥å…ƒç´ å­˜åœ¨:', !!markdownInput);
              
              const markdownText = markdownInput.value.trim();
              console.log('Markdown æ–‡æœ¬é•¿åº¦:', markdownText.length);
              
              if (!markdownText) {
                  alert('è¯·å…ˆè¾“å…¥Markdownæ–‡æœ¬');
                  return;
              }

              // ä½¿ç”¨marked.jsè¿›è¡Œè½¬æ¢
              console.log('æ£€æŸ¥ marked å¯¹è±¡:', !!window.marked);
              console.log('marked.parse å‡½æ•°å­˜åœ¨:', typeof window.marked.parse === 'function');
              
              console.log('è®¾ç½® marked é€‰é¡¹...');
              marked.setOptions({
                  breaks: true,
                  gfm: true,
                  pedantic: false,
                  smartLists: true,
                  smartypants: false
              });

              try {
                  console.log('å¼€å§‹è§£æ Markdown...');
                  const startTime = Date.now();
                  let html = marked.parse(markdownText);
                  const endTime = Date.now();
                  console.log('Markdown è§£æå®Œæˆï¼Œè€—æ—¶:', (endTime - startTime), 'ms');
                  console.log('è§£æç»“æœé•¿åº¦:', html.length);

                  // ç§»é™¤HTMLå‰åå¯èƒ½çš„ç©ºç™½å­—ç¬¦ï¼Œè§£å†³ç¬¬ä¸€è¡Œå‰æœ‰ç©ºæ ¼çš„é—®é¢˜
                  html = html.trim();

                  // ä¸ºè¡¨æ ¼æ·»åŠ word-tableç±»
                  html = html.replace(/<table>/g, '<table class="word-table">');

                  // ä¸ºä»£ç å—æ·»åŠ è¯­è¨€ç±»
                  html = html.replace(/<pre><code>/g, '<pre><code class="language-text">');

                  const outputContent = document.getElementById('outputContent');
                  console.log('è¾“å‡ºå…ƒç´ å­˜åœ¨:', !!outputContent);
                  outputContent.innerHTML = html;
                  console.log('è½¬æ¢å®Œæˆå¹¶æ˜¾ç¤ºç»“æœ');
              } catch (error) {
                  console.error('è½¬æ¢å‡ºé”™:', error);
                  alert('è½¬æ¢å‡ºé”™: ' + error.message);
              }
          }

        // ===== å¤åˆ¶åˆ°å‰ªè´´æ¿å‡½æ•° =====
        function copyToClipboard() {
            const outputContent = document.getElementById('outputContent');
            const btn = document.querySelector('.button-group .button-secondary'); // è·å–å¤åˆ¶æŒ‰é’®
            const originalText = btn.textContent;
            
            // åˆ›å»ºä¸´æ—¶å®¹å™¨ï¼Œåº”ç”¨å®Œæ•´çš„Wordæ ·å¼
            const tempDiv = document.createElement('div');
            
            // ç¡®ä¿æ²¡æœ‰å‰å¯¼ç©ºæ ¼
            const cleanHtml = outputContent.innerHTML.trim();
            tempDiv.innerHTML = cleanHtml;
            
            // åº”ç”¨å®Œæ•´çš„Wordå…¼å®¹æ ·å¼
            tempDiv.style.fontFamily = '"å¾®è½¯é›…é»‘", "Microsoft YaHei", Arial, sans-serif';
            tempDiv.style.fontSize = '14px';
            tempDiv.style.lineHeight = '1.8';
            tempDiv.style.color = '#333';
            tempDiv.style.margin = '0';
            tempDiv.style.padding = '0';
            
            // åˆ›å»ºå®Œæ•´çš„HTMLæ–‡æ¡£ç»“æ„ï¼ŒåŒ…å«Wordæ‰€éœ€çš„æ ·å¼ä¿¡æ¯
            const fullHtml = `
                <!DOCTYPE html>
                <html>
                <head>
                    <meta charset="UTF-8">
                    <style>
                        body {
                            font-family: "å¾®è½¯é›…é»‘", "Microsoft YaHei", Arial, sans-serif;
                            font-size: 14px;
                            line-height: 1.8;
                            color: #333;
                            margin: 0;
                            padding: 0;
                            text-align: justify;
                        }
                        h1 {
                            font-size: 28px;
                            font-weight: bold;
                            margin: 24px 0 16px;
                            color: #1a73e8;
                            border-bottom: 2px solid #1a73e8;
                            padding-bottom: 8px;
                            font-family: "å¾®è½¯é›…é»‘", "Microsoft YaHei", Arial, sans-serif;
                        }
                        h2 {
                            font-size: 22px;
                            font-weight: bold;
                            margin: 20px 0 12px;
                            color: #333;
                            padding-left: 8px;
                            border-left: 4px solid #1a73e8;
                            font-family: "å¾®è½¯é›…é»‘", "Microsoft YaHei", Arial, sans-serif;
                        }
                        h3, h4, h5, h6 {
                            font-weight: bold;
                            font-family: "å¾®è½¯é›…é»‘", "Microsoft YaHei", Arial, sans-serif;
                        }
                        p {
                            margin: 0 0 12px;
                            text-indent: 2em;
                            text-align: justify;
                            font-family: "å¾®è½¯é›…é»‘", "Microsoft YaHei", Arial, sans-serif;
                        }
                        ul, ol {
                            margin: 12px 0;
                            padding-left: 30px;
                        }
                        li {
                            margin: 6px 0;
                            text-align: justify;
                            font-family: "å¾®è½¯é›…é»‘", "Microsoft YaHei", Arial, sans-serif;
                        }
                        code, pre {
                            font-family: Consolas, "Courier New", monospace;
                        }
                        table {
                            border-collapse: collapse;
                            width: 100%;
                        }
                        th, td {
                            border: 1px solid #999;
                            padding: 8px 12px;
                            font-family: "å¾®è½¯é›…é»‘", "Microsoft YaHei", Arial, sans-serif;
                        }
                    </style>
                </head>
                <body>
                    ${cleanHtml}
                </body>
                </html>
            `;
            
            // å¤åˆ¶æ–‡æœ¬å’ŒHTMLä¸¤ç§æ ¼å¼
            const text = tempDiv.innerText;
            const html = fullHtml;
            
            // ä½¿ç”¨ç°ä»£API
            if (navigator.clipboard && window.ClipboardItem) {
                try {
                    const htmlBlob = new Blob([html], { type: 'text/html' });
                    const textBlob = new Blob([text], { type: 'text/plain' });
                    
                    navigator.clipboard.write([
                        new ClipboardItem({
                            'text/html': htmlBlob,
                            'text/plain': textBlob
                        })
                    ]).then(() => {
                        showCopySuccess(btn, originalText);
                    }).catch(() => {
                        // é™çº§åˆ°ä¼ ç»Ÿæ–¹æ³•
                        fallbackCopyMethod(outputContent, btn, originalText);
                    });
                } catch (error) {
                    fallbackCopyMethod(outputContent, btn, originalText);
                }
            } else {
                // ç›´æ¥ä½¿ç”¨ä¼ ç»Ÿæ–¹æ³•
                fallbackCopyMethod(outputContent, btn, originalText);
            }
        }
        
        // å¤‡ç”¨å¤åˆ¶æ–¹æ³•
        function fallbackCopyMethod(element, btn, originalText) {
            const selection = window.getSelection();
            const range = document.createRange();
            
            // æ¸…ç©ºç°æœ‰é€‰æ‹©
            selection.removeAllRanges();
            
            // é€‰æ‹©è¦å¤åˆ¶çš„å†…å®¹
            range.selectNodeContents(element);
            selection.addRange(range);
            
            try {
                // æ‰§è¡Œå¤åˆ¶å‘½ä»¤
                const successful = document.execCommand('copy');
                if (successful) {
                    showCopySuccess(btn, originalText);
                } else {
                    alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å¹¶å¤åˆ¶');
                }
            } catch (error) {
                alert('å¤åˆ¶å¤±è´¥ï¼Œè¯·æ‰‹åŠ¨é€‰æ‹©å¹¶å¤åˆ¶');
            } finally {
                // æ¸…é™¤é€‰æ‹©
                selection.removeAllRanges();
            }
        }
        
        // æ˜¾ç¤ºå¤åˆ¶æˆåŠŸæç¤º
        function showCopySuccess(btn, originalText) {
            btn.textContent = 'âœ… å·²å¤åˆ¶ï¼';
            btn.disabled = true;
            
            setTimeout(() => {
                btn.textContent = originalText;
                btn.disabled = false;
            }, 2000);
        }

        // ===== ä¸‹è½½ä¸ºWordæ–‡ä»¶å‡½æ•° =====
        function downloadAsDoc() {
            const outputContent = document.getElementById('outputContent').innerHTML;
            if (!outputContent.trim()) {
                alert('è¯·å…ˆè½¬æ¢ Markdown å†…å®¹');
                return;
            }
            
            try {
                // ä½¿ç”¨ htmlDocxExport ç”Ÿæˆæ–‡æ¡£
                const blob = htmlDocxExport(outputContent);
                
                // ç”Ÿæˆæ–‡ä»¶å
                const timestamp = new Date().toISOString().slice(0, 10);
                const filename = `markdown-to-word-${timestamp}.doc`;
                
                // ä¸‹è½½æ–‡ä»¶
                saveAs(blob, filename);
            } catch (error) {
                console.error('å¯¼å‡º Word æ–‡æ¡£æ—¶å‡ºé”™:', error);
                alert('å¯¼å‡ºå¤±è´¥ï¼Œè¯·é‡è¯•ã€‚é”™è¯¯ä¿¡æ¯: ' + error.message);
            }
        }

        // ===== é”®ç›˜å¿«æ·é”® =====
        document.addEventListener('keydown', function(event) {
            // Ctrl+Enter æˆ– Cmd+Enter è½¬æ¢
            if ((event.ctrlKey || event.metaKey) && event.key === 'Enter') {
                convertMarkdown();
            }
        });

        // ===== é¡µé¢åŠ è½½å®Œæˆæç¤º =====
        window.addEventListener('load', function() {
            console.log('âœ… Markdownè½¬Wordå·¥å…·å·²åŠ è½½å®Œæˆï¼');
            console.log('å¿«æ·é”®: Ctrl+Enter å¿«é€Ÿè½¬æ¢');
        });
    </script>

<footer style="text-align: center; padding: 20px; color: #777; font-size: 14px; margin-top: 40px; border-top: 1px solid #eee;">
  <p>Â© 2025 â€¢ Markdownè½¬Wordå·¥å…·ï¼Œå°çº¢è–¯â€œæ‹¾è¶£å°ä»™â€çš„åº—ç‰ˆæƒæ‰€æœ‰</p>
  <p>æœ¬åº—ä¸“æ³¨äºæ•ˆç‡æå‡ï¼Œå¸®ä½ æŠŠâ€œè´¹äº‹å„¿â€å˜â€œçœäº‹å„¿â€ï¼Œæ‹¾é—²è¶£ã€å¯»è¶£ç‰©å°½åœ¨å°çº¢è–¯â€œæ‹¾è¶£å°ä»™â€çš„åº—ï½</p>
</footer>

</body>
</html>